events {
    worker_connections 1024;
}

http {
    upstream fraud_api {
        server fraud-api:8001;
    }

    upstream ecommerce_api {
        server ecommerce-api:8002;
    }

    upstream financial_api {
        server financial-api:8003;
    }

    upstream healthcare_api {
        server healthcare-api:8004;
    }

    upstream hr_api {
        server hr-api:8005;
    }

    upstream restaurant_api {
        server restaurant-api:8006;
    }

    server {
        listen 80;
        server_name _;

        # Main landing page
        location / {
            return 200 '
<!DOCTYPE html>
<html>
<head>
    <title>Data Engineering Portfolio - APIs</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 50px auto; padding: 20px; background: #f5f5f5; }
        h1 { color: #333; text-align: center; }
        .api-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 30px; }
        .api-card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .api-card h2 { color: #2563eb; margin-top: 0; }
        .api-card a { display: inline-block; margin: 5px 10px 5px 0; padding: 8px 16px; background: #2563eb; color: white; text-decoration: none; border-radius: 4px; }
        .api-card a:hover { background: #1d4ed8; }
        .status { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; }
        .status.online { background: #10b981; color: white; }
    </style>
</head>
<body>
    <h1>üöÄ Data Engineering Portfolio APIs</h1>
    <p style="text-align: center; color: #666;">Production-ready data engineering projects with REST APIs</p>
    
    <div class="api-grid">
        <div class="api-card">
            <h2>üîí Fraud Detection</h2>
            <span class="status online">ONLINE</span>
            <p>Real-time fraud detection ML system</p>
            <a href="/api/fraud/docs">API Docs</a>
            <a href="/api/fraud/health">Health Check</a>
        </div>
        
        <div class="api-card">
            <h2>üõí E-commerce Analytics</h2>
            <span class="status online">ONLINE</span>
            <p>Customer segmentation & RFM analysis</p>
            <a href="/api/ecommerce/docs">API Docs</a>
            <a href="/api/ecommerce/health">Health Check</a>
        </div>
        
        <div class="api-card">
            <h2>üìà Financial Analytics</h2>
            <span class="status online">ONLINE</span>
            <p>LSTM stock price predictions</p>
            <a href="/api/financial/docs">API Docs</a>
            <a href="/api/financial/health">Health Check</a>
        </div>
        
        <div class="api-card">
            <h2>üè• Healthcare Analytics</h2>
            <span class="status online">ONLINE</span>
            <p>HIPAA-compliant patient analytics</p>
            <a href="/api/healthcare/docs">API Docs</a>
            <a href="/api/healthcare/health">Health Check</a>
        </div>
        
        <div class="api-card">
            <h2>üë• HR Analytics</h2>
            <span class="status online">ONLINE</span>
            <p>Attrition prediction & sentiment analysis</p>
            <a href="/api/hr/docs">API Docs</a>
            <a href="/api/hr/health">Health Check</a>
        </div>
        
        <div class="api-card">
            <h2>üçΩÔ∏è Restaurant Analytics</h2>
            <span class="status online">ONLINE</span>
            <p>Review sentiment analysis & NLP</p>
            <a href="/api/restaurant/docs">API Docs</a>
            <a href="/api/restaurant/health">Health Check</a>
        </div>
    </div>
    
    <footer style="text-align: center; margin-top: 50px; color: #666;">
        <p>Built with Python, FastAPI, Docker | <a href="https://github.com/vamegah/data-engineering" style="color: #2563eb;">View on GitHub</a></p>
    </footer>
</body>
</html>';
            add_header Content-Type text/html;
        }

        # Fraud Detection API
        location /api/fraud/ {
            proxy_pass http://fraud_api/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }

        # E-commerce API
        location /api/ecommerce/ {
            proxy_pass http://ecommerce_api/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }

        # Financial API
        location /api/financial/ {
            proxy_pass http://financial_api/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }

        # Healthcare API
        location /api/healthcare/ {
            proxy_pass http://healthcare_api/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }

        # HR API
        location /api/hr/ {
            proxy_pass http://hr_api/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }

        # Restaurant API
        location /api/restaurant/ {
            proxy_pass http://restaurant_api/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        }
    }
}
